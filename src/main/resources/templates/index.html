<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>HealthCare.com</title>
    <link rel="icon" th:href="@{/img/common/favicon.ico}" href="../static/img/common/favicon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" th:href="@{/css/style.css}" />

  </head>
  <body>
    <header>
      <a href="#" th:href="@{/}">
        <img class="header-logo" th:src="@{/img/common/healthcare.png}" src="../static/img/common/healthcare.png" />
        <strong>HealthCare.com</strong>
      </a>
      <a href="#" th:href="@{/logout}">
  <img class="logout-icon" th:src="@{/img/common/exit.svg}" src="../static/img/common/exit.svg" />
  ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
</a>
    </header>

    <main>
      <h1 id="dashboard-title" class="page-title"></h1>
      <div class="grid-container">
        <div class="card">
          <h3>General Functions</h3>
          <ul>
            <li><a href="#" th:href="@{/task}">Task Management</a></li>
            <li><a href="#" th:href="@{/avgPace}">Running Pace Calculation</a></li>
            <li><a href="#" th:href="@{/runLog}">Running Log</a></li>
          </ul>
        </div>

        <div class="card">
          <h3>Game</h3>
          <section class="sprint-section">
            <div class="sprint-container">
              <h2>ğŸƒâ€â™‚ï¸ é€£æ‰“ã§100mèµ°ï¼</h2>
              <canvas id="sprintCanvas" width="600" height="100"></canvas>
              <div class="sprint-info">
                <span id="sprintTimer">ã‚¿ã‚¤ãƒ : 0.00 ç§’</span>
                <button id="retryButton">ğŸ”„ ãƒªãƒˆãƒ©ã‚¤</button>
              </div>
              <p id="sprintResult"></p>
            </div>
          </section>

        </div>
      </div>

      <!-- ã‚²ãƒ¼ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
<section class="game-section">
  <div class="game-container">
    <canvas id="gameCanvas" width="600" height="200"></canvas>
  </div>
</section>
    <div class="card">
      <h1>åå°„ç¥çµŒãƒ†ã‚¹ãƒˆ</h1>
      <div id="game-area">ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã­</div>
      <button id="start-btn">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
      <div id="result"></div>
    </div>
    </main>

    <footer>
      &copy; 2025 HealthCare.com
    </footer>

    <script>
      function updateDateTime() {
        const now = new Date();
        const options = {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit',
        };
        const formatted = now.toLocaleString('ja-JP', options);
        document.getElementById('dashboard-title').textContent = `ğŸ—“ ${formatted}`;
      }
      updateDateTime();
      setInterval(updateDateTime, 1000);
    </script>

    <script>
      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d");
      const runnerImg = new Image();
      runnerImg.src = "/img/common/runner.gif";
      const obstacleImg = new Image();
      obstacleImg.src = "/img/common/obstacle.png";
      const bgImg = new Image();
      bgImg.src = "/img/common/background.png";

      let isRunning = true;
      let score = 0;
      let highScore = 0;
      let player = { x: 50, y: 150, width: 40, height: 40, vy: 0, jump: false };
      const gravity = 1;
      const ground = 150;
      let obstacle = { x: 600, y: 150, width: 40, height: 40, speed: 4 };

      document.addEventListener("keydown", (e) => {
        if (e.code === "Space" && !player.jump && isRunning) {
          player.vy = -15;
          player.jump = true;
        }
        if (e.code === "KeyR" && !isRunning) {
          restartGame();
        }
      });

      function update() {
        if (!isRunning) return;
        player.y += player.vy;
        player.vy += gravity;
        if (player.y >= ground) {
          player.y = ground;
          player.jump = false;
        }
        obstacle.x -= obstacle.speed;
        if (obstacle.x < -obstacle.width) {
          obstacle.x = 600 + Math.random() * 100;
          score += 10;
          if (score > highScore) highScore = score;
        }
        if (
          player.x < obstacle.x + obstacle.width &&
          player.x + player.width > obstacle.x &&
          player.y < obstacle.y + obstacle.height &&
          player.y + player.height > obstacle.y
        ) {
          isRunning = false;
        }
      }

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);
        ctx.drawImage(runnerImg, player.x, player.y, player.width, player.height);
        ctx.drawImage(obstacleImg, obstacle.x, obstacle.y, obstacle.width, obstacle.height);
        ctx.fillStyle = "#ffffff";
        ctx.font = "16px Roboto";
        ctx.fillText("Score: " + score, 10, 20);
        ctx.fillText("High Score: " + highScore, 10, 40);
        if (!isRunning) {
          ctx.fillStyle = "rgba(0,0,0,0.6)";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = "#fff";
          ctx.font = "24px Roboto";
          ctx.fillText("Game Over", 230, 100);
          ctx.font = "16px Roboto";
          ctx.fillText("Press R to Restart", 220, 130);
        }
      }

      function gameLoop() {
        update();
        draw();
        requestAnimationFrame(gameLoop);
      }

      function restartGame() {
        player.y = 150;
        player.vy = 0;
        obstacle.x = 600;
        score = 0;
        isRunning = true;
      }

      bgImg.onload = () => {
        gameLoop();
      };
    </script>

    <script>
      const sprintCanvas = document.getElementById("sprintCanvas");
      const sprintCtx = sprintCanvas.getContext("2d");

      let runnerPos = 0;
      let lastKey = "";
      let startTime = null;
      let finished = false;
      let timerInterval = null;

      function drawSprintRunner() {
        sprintCtx.clearRect(0, 0, sprintCanvas.width, sprintCanvas.height);
        sprintCtx.fillStyle = "#2196f3";
        sprintCtx.fillRect(runnerPos, 60, 20, 30); // ãƒ©ãƒ³ãƒŠãƒ¼
        sprintCtx.fillStyle = "#000";
        sprintCtx.fillRect(580, 0, 5, 100); // ã‚´ãƒ¼ãƒ«ãƒ©ã‚¤ãƒ³
      }

      function updateTimer() {
        if (!startTime || finished) return;
        const now = performance.now();
        const time = ((now - startTime) / 1000).toFixed(2);
        document.getElementById("sprintTimer").textContent = `ã‚¿ã‚¤ãƒ : ${time} ç§’`;
      }

      function resetSprintGame() {
        runnerPos = 0;
        lastKey = "";
        startTime = null;
        finished = false;
        document.getElementById("sprintResult").textContent = "â†â†’ã‚­ãƒ¼äº¤äº’ã§é€£æ‰“ã—ã¦ã‚´ãƒ¼ãƒ«ã‚’ç›®æŒ‡ã›ï¼ï¼ˆ100mèµ°ï¼‰";
        document.getElementById("sprintTimer").textContent = `ã‚¿ã‚¤ãƒ : 0.00 ç§’`;
        drawSprintRunner();
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(updateTimer, 50);
      }

      document.addEventListener("keydown", (e) => {
        if (finished) return;
        if (e.code === "ArrowLeft" || e.code === "ArrowRight") {
          if (lastKey !== e.code) {
            if (!startTime) {
              startTime = performance.now();
              timerInterval = setInterval(updateTimer, 50);
            }
            runnerPos += 5;
            lastKey = e.code;
            drawSprintRunner();
            if (runnerPos >= 580) {
              finished = true;
              const time = ((performance.now() - startTime) / 1000).toFixed(2);
              document.getElementById("sprintResult").textContent = `ğŸ‰ ã‚´ãƒ¼ãƒ«ï¼ã‚¿ã‚¤ãƒ : ${time} ç§’`;
              clearInterval(timerInterval);
            }
          }
        }
      });

      document.getElementById("retryButton").addEventListener("click", resetSprintGame);

      resetSprintGame();
    </script>

    <script>
      const gameArea = document.getElementById("game-area");
      const startBtn = document.getElementById("start-btn");
      const result = document.getElementById("result");
      let canClick = false;
      let startTime2 = 0;
      let timeoutId = null;

    startBtn.onclick = function() {
      result.textContent = "";
      gameArea.textContent = "èµ¤ã®ã¾ã¾å¾…ã£ã¦ã¦ã­";
      gameArea.style.background = "#ff5252";
      canClick = false;
      startBtn.disabled = true;

      // ãƒ©ãƒ³ãƒ€ãƒ ãªå¾…ã¡æ™‚é–“ï¼ˆ1ã€œ3ç§’ï¼‰
      const waitTime = Math.random() * 2000 + 1000;
      timeoutId = setTimeout(() => {
        gameArea.textContent = "ä»Šã™ãã‚¯ãƒªãƒƒã‚¯ï¼";
        gameArea.style.background = "#43a047";
        canClick = true;
        startTime2 = performance.now();
      }, waitTime);
    };
    gameArea.onclick = function() {
      if (!startBtn.disabled) return; // ã‚²ãƒ¼ãƒ ä¸­ä»¥å¤–ã¯ä½•ã‚‚ã—ãªã„
      if (canClick) {
        const reaction = performance.now() - startTime2;
        gameArea.textContent = "çµæœï¼š" + reaction.toFixed(0) + " ãƒŸãƒªç§’";
        result.textContent = "ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã‚ˆã†ï¼";
        gameArea.style.background = "#1976d2";
        canClick = false;
        startBtn.disabled = false;
      } else {
        clearTimeout(timeoutId);
        gameArea.textContent = "ãƒ•ãƒ©ã‚¤ãƒ³ã‚°ï¼ã‚‚ã†ä¸€åº¦ã‚¹ã‚¿ãƒ¼ãƒˆ";
        result.textContent = "";
        gameArea.style.background = "#ffb300";
        startBtn.disabled = false;
      }
    };
  </script>
  </body>
</html>
